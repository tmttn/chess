import{f as T,a as x,d as Ie,e as Ne,c as $e,s as R}from"../chunks/D8GwXruM.js";import{v as He,C as Lt,J as je,y as ce,W as Nt,E as Ot,b as a,a as At,G as Dt,H as Bt,I as Ze,K as Fe,z as Ae,X as Ht,aR as jt,av as et,o as Te,aZ as be,x as Ue,B as Ft,D as De,O as Rt,af as tt,aP as Ye,a_ as vt,a$ as Gt,b0 as Vt,b1 as Wt,r as ct,t as ut,b2 as Re,Y as Ut,aM as qt,q as zt,b3 as dt,aj as ft,b4 as Kt,M as Yt,b5 as Jt,b6 as Qt,b7 as Xt,b8 as Zt,b9 as ea,ba as ta,bb as aa,bc as sa,bd as _t,u as pt,ah as gt,be as at,bf as na,bg as ra,Z as ge,a7 as K,aY as N,a0 as he,a5 as _,a4 as h,a6 as v,bh as ht,_ as bt,$ as pe,s as te,a1 as xe,n as Be,w as oa,R as Ge,aw as mt}from"../chunks/B7_9F9Xb.js";import{i as z,s as Ce,a as W}from"../chunks/BWKNUDvW.js";import{a as la,p as wt}from"../chunks/BMwdwKh4.js";import{b as ia,s as kt,g as J,a as yt,l as xt,t as va,c as ca,d as Je,v as ua,m as da,e as St,f as fa,h as _a,j as pa,k as ga,n as ha}from"../chunks/DjgecNuE.js";function fe(e,t){return t}function ba(e,t,s){for(var n=[],c=t.length,u,p=t.length,g=0;g<c;g++){let m=t[g];ut(m,()=>{if(u){if(u.pending.delete(m),u.done.add(m),u.pending.size===0){var o=e.outrogroups;qe(Ye(u.done)),o.delete(u),o.size===0&&(e.outrogroups=null)}}else p-=1},!1)}if(p===0){var b=n.length===0&&s!==null;if(b){var r=s,i=r.parentNode;qt(i),i.append(r),e.items.clear()}qe(t,!b)}else u={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(u)}function qe(e,t=!0){for(var s=0;s<e.length;s++)zt(e[s],t)}var st;function _e(e,t,s,n,c,u=null){var p=e,g=new Map,b=(t&dt)!==0;if(b){var r=e;p=ce?je(Nt(r)):r.appendChild(He())}ce&&Ot();var i=null,m=At(()=>{var y=s();return vt(y)?y:y==null?[]:Ye(y)}),o,f=!0;function S(){l.fallback=i,ma(l,o,p,t,n),i!==null&&(o.length===0?(i.f&be)===0?ct(i):(i.f^=be,Le(i,null,p)):ut(i,()=>{i=null}))}var M=Lt(()=>{o=a(m);var y=o.length;let k=!1;if(ce){var H=Dt(p)===Bt;H!==(y===0)&&(p=Ze(),je(p),Fe(!1),k=!0)}for(var $=new Set,G=Te,ee=Ft(),D=0;D<y;D+=1){ce&&Ae.nodeType===Ht&&Ae.data===jt&&(p=Ae,k=!0,Fe(!1));var O=o[D],j=n(O,D),B=f?null:g.get(j);B?(B.v&&et(B.v,O),B.i&&et(B.i,D),ee&&G.skipped_effects.delete(B.e)):(B=wa(g,f?p:st??=He(),O,j,D,c,t,s),f||(B.e.f|=be),g.set(j,B)),$.add(j)}if(y===0&&u&&!i&&(f?i=Ue(()=>u(p)):(i=Ue(()=>u(st??=He())),i.f|=be)),ce&&y>0&&je(Ze()),!f)if(ee){for(const[ne,I]of g)$.has(ne)||G.skipped_effects.add(I.e);G.oncommit(S),G.ondiscard(()=>{})}else S();k&&Fe(!0),a(m)}),l={effect:M,items:g,outrogroups:null,fallback:i};f=!1,ce&&(p=Ae)}function ma(e,t,s,n,c){var u=(n&Kt)!==0,p=t.length,g=e.items,b=e.effect.first,r,i=null,m,o=[],f=[],S,M,l,y;if(u)for(y=0;y<p;y+=1)S=t[y],M=c(S,y),l=g.get(M).e,(l.f&be)===0&&(l.nodes?.a?.measure(),(m??=new Set).add(l));for(y=0;y<p;y+=1){if(S=t[y],M=c(S,y),l=g.get(M).e,e.outrogroups!==null)for(const B of e.outrogroups)B.pending.delete(l),B.done.delete(l);if((l.f&be)!==0)if(l.f^=be,l===b)Le(l,null,s);else{var k=i?i.next:b;l===e.effect.last&&(e.effect.last=l.prev),l.prev&&(l.prev.next=l.next),l.next&&(l.next.prev=l.prev),ye(e,i,l),ye(e,l,k),Le(l,k,s),i=l,o=[],f=[],b=i.next;continue}if((l.f&Re)!==0&&(ct(l),u&&(l.nodes?.a?.unfix(),(m??=new Set).delete(l))),l!==b){if(r!==void 0&&r.has(l)){if(o.length<f.length){var H=f[0],$;i=H.prev;var G=o[0],ee=o[o.length-1];for($=0;$<o.length;$+=1)Le(o[$],H,s);for($=0;$<f.length;$+=1)r.delete(f[$]);ye(e,G.prev,ee.next),ye(e,i,G),ye(e,ee,H),b=H,i=ee,y-=1,o=[],f=[]}else r.delete(l),Le(l,b,s),ye(e,l.prev,l.next),ye(e,l,i===null?e.effect.first:i.next),ye(e,i,l),i=l;continue}for(o=[],f=[];b!==null&&b!==l;)(r??=new Set).add(b),f.push(b),b=b.next;if(b===null)continue}(l.f&be)===0&&o.push(l),i=l,b=l.next}if(e.outrogroups!==null){for(const B of e.outrogroups)B.pending.size===0&&(qe(Ye(B.done)),e.outrogroups?.delete(B));e.outrogroups.size===0&&(e.outrogroups=null)}if(b!==null||r!==void 0){var D=[];if(r!==void 0)for(l of r)(l.f&Re)===0&&D.push(l);for(;b!==null;)(b.f&Re)===0&&b!==e.fallback&&D.push(b),b=b.next;var O=D.length;if(O>0){var j=(n&dt)!==0&&p===0?s:null;if(u){for(y=0;y<O;y+=1)D[y].nodes?.a?.measure();for(y=0;y<O;y+=1)D[y].nodes?.a?.fix()}ba(e,D,j)}}u&&ft(()=>{if(m!==void 0)for(l of m)l.nodes?.a?.apply()})}function wa(e,t,s,n,c,u,p,g){var b=(p&Gt)!==0?(p&Vt)===0?Rt(s,!1,!1):tt(s):null,r=(p&Wt)!==0?tt(c):null;return De&&b&&(b.trace=()=>{g()[r?.v??c]}),{v:b,i:r,e:Ue(()=>(u(t,b??s,r??c,g),()=>{e.delete(n)}))}}function Le(e,t,s){if(e.nodes)for(var n=e.nodes.start,c=e.nodes.end,u=t&&(t.f&be)===0?t.nodes.start:s;n!==null;){var p=Ut(n);if(u.before(n),n===c)return;n=p}}function ye(e,t,s){t===null?e.effect.first=s:t.next=s,s===null?e.effect.last=t:s.prev=t}function Se(e,t,s,n,c,u){var p=e.__className;if(ce||p!==s||p===void 0){var g=la(s,n,u);(!ce||g!==e.getAttribute("class"))&&(g==null?e.removeAttribute("class"):e.className=g),e.__className=s}else if(u&&c!==u)for(var b in u){var r=!!u[b];(c==null||r!==!!c[b])&&e.classList.toggle(b,r)}return u}function ze(e,t,s=!1){if(e.multiple){if(t==null)return;if(!vt(t))return Jt();for(var n of e.options)n.selected=t.includes(rt(n));return}for(n of e.options){var c=rt(n);if(Qt(c,t)){n.selected=!0;return}}(!s||t!==void 0)&&(e.selectedIndex=-1)}function nt(e){var t=new MutationObserver(()=>{ze(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Yt(()=>{t.disconnect()})}function rt(e){return"__value"in e?e.__value:e.value}const ka=Symbol("is custom element"),ya=Symbol("is html");function Qe(e){if(ce){var t=!1,s=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var n=e.value;me(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var c=e.checked;me(e,"checked",null),e.checked=c}}};e.__on_r=s,ft(s),ea()}}function xa(e,t){var s=Mt(e);s.checked!==(s.checked=t??void 0)&&(e.checked=t)}function me(e,t,s,n){var c=Mt(e);if(ce&&(c[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")){Ma(e,t,s??"");return}c[t]!==(c[t]=s)&&(t==="loading"&&(e[ta]=s),s==null?e.removeAttribute(t):typeof s!="string"&&Sa(e).includes(t)?e[t]=s:e.setAttribute(t,s))}function Mt(e){return e.__attributes??={[ka]:e.nodeName.includes("-"),[ya]:e.namespaceURI===Xt}}var ot=new Map;function Sa(e){var t=e.getAttribute("is")||e.nodeName,s=ot.get(t);if(s)return s;ot.set(t,s=[]);for(var n,c=e,u=Element.prototype;u!==c;){n=aa(c);for(var p in n)n[p].set&&s.push(p);c=Zt(c)}return s}function Ma(e,t,s){De&&(t==="srcset"&&Ta(e,s)||Ke(e.getAttribute(t)??"",s)||sa(t,e.outerHTML.replace(e.innerHTML,e.innerHTML&&"..."),String(s)))}function Ke(e,t){return e===t?!0:new URL(e,document.baseURI).href===new URL(t,document.baseURI).href}function lt(e){return e.split(",").map(t=>t.trim().split(" ").filter(Boolean))}function Ta(e,t){var s=lt(e.srcset),n=lt(t);return n.length===s.length&&n.every(([c,u],p)=>u===s[p][1]&&(Ke(s[p][0],c)||Ke(c,s[p][0])))}function $a(e,t,s=t){var n=new WeakSet;_t(e,"input",async c=>{De&&e.type==="checkbox"&&at();var u=c?e.defaultValue:e.value;if(u=Ve(e)?We(u):u,s(u),Te!==null&&n.add(Te),await na(),u!==(u=t())){var p=e.selectionStart,g=e.selectionEnd,b=e.value.length;if(e.value=u??"",g!==null){var r=e.value.length;p===g&&g===b&&r>b?(e.selectionStart=r,e.selectionEnd=r):(e.selectionStart=p,e.selectionEnd=Math.min(g,r))}}}),(ce&&e.defaultValue!==e.value||pt(t)==null&&e.value)&&(s(Ve(e)?We(e.value):e.value),Te!==null&&n.add(Te)),gt(()=>{De&&e.type==="checkbox"&&at();var c=t();if(e===document.activeElement){var u=ra??Te;if(n.has(u))return}Ve(e)&&c===We(e.value)||e.type==="date"&&!c&&!e.value||c!==e.value&&(e.value=c??"")})}function Ia(e,t,s=t){_t(e,"change",n=>{var c=n?e.defaultChecked:e.checked;s(c)}),(ce&&e.defaultChecked!==e.checked||pt(t)==null)&&s(e.checked),gt(()=>{var n=t();e.checked=!!n})}function Ve(e){var t=e.type;return t==="number"||t==="range"}function We(e){return e===""?null:+e}var Ca=T('<img draggable="false"/>');function Ea(e,t){ge(t,!0);let s=wt(t,"draggable",3,!0);const n="cburnett",c={k:"K",q:"Q",r:"R",b:"B",n:"N",p:"P"},u=N(()=>()=>`${t.piece.color==="white"?"w":"b"}${c[t.piece.type]}`),p=N(()=>`https://lichess1.org/assets/piece/${n}/${a(u)()}.svg`);var g=Ca();let b;K(()=>{me(g,"src",a(p)),me(g,"alt",`${t.piece.color} ${t.piece.type}`),b=Se(g,1,"piece svelte-19fm6zq",null,b,{draggable:s()})}),x(e,g),he()}var Pa=T('<div class="piece-wrapper svelte-gxsx5p" draggable="true" role="button" tabindex="0"><!></div>'),La=T('<div class="legal-dot svelte-gxsx5p"></div>'),Na=T('<div class="legal-ring svelte-gxsx5p"></div>'),Oa=T('<div role="button" tabindex="0"><!> <!> <!></div>');function Aa(e,t){ge(t,!0);var s=Oa();let n;s.__click=function(...i){t.onclick?.apply(this,i)},s.__keydown=i=>i.key==="Enter"&&t.onclick();var c=_(s);{var u=i=>{var m=Pa(),o=_(m);Ea(o,{get piece(){return t.piece}}),v(m),Ne("dragstart",m,function(...f){t.ondragstart?.apply(this,f)}),x(i,m)};z(c,i=>{t.piece&&i(u)})}var p=h(c,2);{var g=i=>{var m=La();x(i,m)};z(p,i=>{t.isLegalTarget&&!t.piece&&i(g)})}var b=h(p,2);{var r=i=>{var m=Na();x(i,m)};z(b,i=>{t.isLegalTarget&&t.piece&&i(r)})}v(s),K(()=>{n=Se(s,1,"square svelte-gxsx5p",null,n,{light:t.isLight,dark:!t.isLight,selected:t.isSelected,"legal-target":t.isLegalTarget,"last-move":t.isLastMove,check:t.isCheck}),me(s,"data-square",t.square)}),Ne("dragover",s,function(...i){t.ondragover?.apply(this,i)}),Ne("drop",s,function(...i){t.ondrop?.apply(this,i)}),x(e,s),he()}Ie(["click","keydown"]);var Da=T('<button class="piece-button svelte-umcm71"><img class="svelte-umcm71"/></button>'),Ba=T('<div class="overlay svelte-umcm71" role="button" tabindex="-1"><div class="dialog svelte-umcm71" role="dialog" aria-label="Choose promotion piece"><div class="title svelte-umcm71">Promote to:</div> <div class="pieces svelte-umcm71"></div></div></div>');function Ha(e,t){ge(t,!0);const s="cburnett",n=[{type:"q",label:"Queen"},{type:"r",label:"Rook"},{type:"b",label:"Bishop"},{type:"n",label:"Knight"}];function c(r){const i=t.color==="white"?"w":"b";return`https://lichess1.org/assets/piece/${s}/${i}${r.toUpperCase()}.svg`}function u(r){r.key==="Escape"&&t.oncancel()}var p=Ba();Ne("keydown",ht,u),p.__click=function(...r){t.oncancel?.apply(this,r)};var g=_(p);g.__click=r=>r.stopPropagation();var b=h(_(g),2);_e(b,21,()=>n,fe,(r,i)=>{var m=Da();m.__click=()=>t.onselect(a(i).type);var o=_(m);v(m),K(f=>{me(m,"title",a(i).label),me(o,"src",f),me(o,"alt",a(i).label)},[()=>c(a(i).type)]),x(r,m)}),v(b),v(g),v(p),x(e,p),he()}Ie(["click"]);var ja=T('<span class="svelte-jpc25w"> </span>'),Fa=T('<span class="svelte-jpc25w"> </span>'),Ra=T('<div class="board-container svelte-jpc25w"><div class="board svelte-jpc25w"></div> <div class="coordinates files svelte-jpc25w"></div> <div class="coordinates ranks svelte-jpc25w"></div></div> <!>',1);function Ga(e,t){ge(t,!0);const s=()=>W(xt,"$legalMoves",p),n=()=>W(yt,"$isCheck",p),c=()=>W(ia,"$board",p),u=()=>W(kt,"$sideToMove",p),[p,g]=Ce();let b=wt(t,"flipped",3,!1),r=xe(null),i=xe(null),m=xe(null);const o=["a","b","c","d","e","f","g","h"],f=["8","7","6","5","4","3","2","1"],S=N(()=>b()?[...o].reverse():o),M=N(()=>b()?[...f].reverse():f);function l(d,w){const E=o.indexOf(d),P=parseInt(w);return(E+P)%2===1}function y(d){return s().filter(w=>w.from===d)}function k(d){return a(r)?y(a(r)).some(w=>w.to===d):!1}function H(d){if(!n())return!1;const w=c().get(d);return w?.type==="k"&&w.color===u()}function $(d,w){return y(d).filter(P=>P.to===w).some(P=>P.promotion)}function G(d,w,E){const P=y(d).filter(Q=>Q.to===w),q=E?P.find(Q=>Q.promotion===E):P[0];q&&(J.makeMove(q.uci),te(i,{from:d,to:w},!0)),te(r,null),te(m,null)}function ee(d){a(m)&&G(a(m).from,a(m).to,d)}function D(){te(m,null),te(r,null)}function O(d){const w=c().get(d);if(a(r)&&k(d)){$(a(r),d)?te(m,{from:a(r),to:d},!0):G(a(r),d);return}if(w&&w.color===u()){te(r,d,!0);return}te(r,null)}function j(d,w){const E=c().get(w);if(!E||E.color!==u()){d.preventDefault();return}te(r,w,!0),d.dataTransfer.effectAllowed="move",d.dataTransfer.setData("text/plain",w);const P=d.target.querySelector("img");if(P){const q=P.offsetWidth;d.dataTransfer.setDragImage(P,q/2,q/2)}}function B(d,w){a(r)&&k(w)&&(d.preventDefault(),d.dataTransfer.dropEffect="move")}function ne(d,w){d.preventDefault(),a(r)&&k(w)?$(a(r),w)?te(m,{from:a(r),to:w},!0):G(a(r),w):te(r,null)}bt(()=>{c(),te(r,null)});var I=Ra(),V=pe(I),A=_(V);_e(A,21,()=>a(M),fe,(d,w)=>{var E=$e(),P=pe(E);_e(P,17,()=>a(S),fe,(q,Q)=>{const Y=N(()=>a(Q)+a(w)),ue=N(()=>c().get(a(Y))??null);{let re=N(()=>l(a(Q),a(w))),le=N(()=>a(r)===a(Y)),ie=N(()=>k(a(Y))),we=N(()=>a(i)?.from===a(Y)||a(i)?.to===a(Y)),ke=N(()=>H(a(Y)));Aa(q,{get square(){return a(Y)},get piece(){return a(ue)},get isLight(){return a(re)},get isSelected(){return a(le)},get isLegalTarget(){return a(ie)},get isLastMove(){return a(we)},get isCheck(){return a(ke)},onclick:()=>O(a(Y)),ondragstart:X=>j(X,a(Y)),ondragover:X=>B(X,a(Y)),ondrop:X=>ne(X,a(Y))})}}),x(d,E)}),v(A);var F=h(A,2);_e(F,21,()=>a(S),fe,(d,w)=>{var E=ja(),P=_(E,!0);v(E),K(()=>R(P,a(w))),x(d,E)}),v(F);var ae=h(F,2);_e(ae,21,()=>a(M),fe,(d,w)=>{var E=Fa(),P=_(E,!0);v(E),K(()=>R(P,a(w))),x(d,E)}),v(ae),v(V);var U=h(V,2);{var C=d=>{Ha(d,{get color(){return u()},onselect:ee,oncancel:D})};z(U,d=>{a(m)&&d(C)})}x(e,I),he(),g()}var Va=T('<div class="viewing-indicator svelte-ls6s80"><span> </span> <button class="go-live-btn svelte-ls6s80">Go to live</button></div>'),Wa=T('<div class="controls svelte-ls6s80"><button title="New Game" class="svelte-ls6s80"><span class="icon svelte-ls6s80">‚Üª</span> New</button> <button title="Flip Board" class="svelte-ls6s80"><span class="icon svelte-ls6s80">‚áÖ</span> Flip</button> <div class="nav-group svelte-ls6s80"><button title="Go to start" class="nav-btn svelte-ls6s80">‚èÆ</button> <button title="Previous move" class="nav-btn svelte-ls6s80">‚óÄ</button> <button title="Next move" class="nav-btn svelte-ls6s80">‚ñ∂</button> <button title="Go to live position" class="nav-btn svelte-ls6s80">‚è≠</button></div> <button class="svelte-ls6s80"><span class="icon svelte-ls6s80"> </span></button></div> <!>',1);function Ua(e,t){ge(t,!0);const s=()=>W(ua,"$viewIndex",p),n=()=>W(da,"$moveCount",p),c=()=>W(Je,"$isViewingHistory",p),u=()=>W(ca,"$isMuted",p),[p,g]=Ce();let b=N(()=>s()>=0),r=N(()=>s()<n()-1),i=N(c);var m=Wa(),o=pe(m),f=_(o);f.__click=()=>J.newGame();var S=h(f,2);S.__click=function(...j){t.onflip?.apply(this,j)};var M=h(S,2),l=_(M);l.__click=()=>J.goToStart();var y=h(l,2);y.__click=()=>J.viewPrev();var k=h(y,2);k.__click=()=>J.viewNext();var H=h(k,2);H.__click=()=>J.goToLive(),v(M);var $=h(M,2);$.__click=function(...j){va?.apply(this,j)};var G=_($),ee=_(G,!0);v(G),v($),v(o);var D=h(o,2);{var O=j=>{var B=Va(),ne=_(B),I=_(ne);v(ne);var V=h(ne,2);V.__click=()=>J.goToLive(),v(B),K(()=>R(I,`Viewing move ${s()+1} of ${n()??""}`)),x(j,B)};z(D,j=>{a(i)&&j(O)})}K(()=>{l.disabled=!a(b),y.disabled=!a(b),k.disabled=!a(r),H.disabled=!a(r),me($,"title",u()?"Unmute":"Mute"),R(ee,u()?"üîá":"üîä")}),x(e,m),he(),g()}Ie(["click"]);var qa=T('<p class="empty svelte-2ad0nb">No moves yet</p>'),za=T("<button> </button>"),Ka=T('<span class="move white svelte-2ad0nb"></span>'),Ya=T("<button> </button>"),Ja=T('<span class="move black svelte-2ad0nb"></span>'),Qa=T('<div class="move-row svelte-2ad0nb"><span class="move-number svelte-2ad0nb"> </span> <!> <!></div>'),Xa=T('<div class="result svelte-2ad0nb"> </div>'),Za=T("<!> <!>",1),es=T('<div class="move-history svelte-2ad0nb"><div class="header svelte-2ad0nb"><h3 class="svelte-2ad0nb">Moves</h3> <button class="notation-toggle svelte-2ad0nb" title="Toggle notation"> </button></div> <div class="moves-list svelte-2ad0nb"><!></div></div>');function ts(e,t){ge(t,!0);const s=()=>W(J,"$gameStore",n),[n,c]=Ce();let u=xe(!1);const p=N(()=>{const k=s().moveHistory,H=[];for(let $=0;$<k.length;$+=2)H.push({number:Math.floor($/2)+1,white:k[$]?{san:k[$].san,uci:k[$].uci,index:$}:null,black:k[$+1]?{san:k[$+1].san,uci:k[$+1].uci,index:$+1}:null});return H}),g=N(()=>{const k=s().result;return k?k==="white_wins"?"1-0":k==="black_wins"?"0-1":"¬Ω-¬Ω":null});function b(k){J.goToMove(k)}function r(k){return a(u)?k.uci:k.san}var i=es(),m=_(i),o=h(_(m),2);o.__click=()=>te(u,!a(u));var f=_(o,!0);v(o),v(m);var S=h(m,2),M=_(S);{var l=k=>{var H=qa();x(k,H)},y=k=>{var H=Za(),$=pe(H);_e($,17,()=>a(p),fe,(D,O)=>{var j=Qa(),B=_(j),ne=_(B);v(B);var I=h(B,2);{var V=C=>{var d=za();let w;d.__click=()=>b(a(O).white.index);var E=_(d,!0);v(d),K(P=>{w=Se(d,1,"move white svelte-2ad0nb",null,w,{active:s().viewIndex===a(O).white.index}),R(E,P)},[()=>r(a(O).white)]),x(C,d)},A=C=>{var d=Ka();x(C,d)};z(I,C=>{a(O).white?C(V):C(A,!1)})}var F=h(I,2);{var ae=C=>{var d=Ya();let w;d.__click=()=>b(a(O).black.index);var E=_(d,!0);v(d),K(P=>{w=Se(d,1,"move black svelte-2ad0nb",null,w,{active:s().viewIndex===a(O).black.index}),R(E,P)},[()=>r(a(O).black)]),x(C,d)},U=C=>{var d=Ja();x(C,d)};z(F,C=>{a(O).black?C(ae):C(U,!1)})}v(j),K(()=>R(ne,`${a(O).number??""}.`)),x(D,j)});var G=h($,2);{var ee=D=>{var O=Xa(),j=_(O,!0);v(O),K(()=>R(j,a(g))),x(D,O)};z(G,D=>{a(g)&&D(ee)})}x(k,H)};z(M,k=>{a(p).length===0?k(l):k(y,!1)})}v(S),v(i),K(()=>R(f,a(u)?"UCI":"SAN")),x(e,i),he(),c()}Ie(["click"]);var as=T('<div class="history-notice svelte-1ftjkv9">Viewing historical position</div>'),ss=T('<p class="error svelte-1ftjkv9"> </p>'),ns=T('<button class="move-btn monospace svelte-1ftjkv9"> </button>'),rs=T('<div class="debug-panel svelte-1ftjkv9"><h3 class="svelte-1ftjkv9">Debug</h3> <!> <section class="fen-section svelte-1ftjkv9"><label for="fen-input" class="svelte-1ftjkv9"> </label> <div class="fen-row svelte-1ftjkv9"><input id="fen-input" type="text" class="monospace svelte-1ftjkv9" placeholder="Enter FEN..."/> <button class="svelte-1ftjkv9">Load</button> <button class="svelte-1ftjkv9">Copy</button></div> <!></section> <section class="state-section svelte-1ftjkv9"><h4 class="svelte-1ftjkv9"> </h4> <dl class="svelte-1ftjkv9"><dt class="svelte-1ftjkv9">Turn</dt> <dd class="svelte-1ftjkv9"><span></span> </dd> <dt class="svelte-1ftjkv9">Status</dt> <dd> </dd> <dt class="svelte-1ftjkv9">Halfmove Clock</dt> <dd class="monospace svelte-1ftjkv9"> </dd> <dt class="svelte-1ftjkv9">Fullmove</dt> <dd class="monospace svelte-1ftjkv9"> </dd></dl></section> <section class="moves-section svelte-1ftjkv9"><h4 class="svelte-1ftjkv9"> </h4> <div class="moves-grid svelte-1ftjkv9"></div></section></div>');function os(e,t){ge(t,!0);const s=()=>W(Je,"$isViewingHistory",r),n=()=>W(pa,"$viewFen",r),c=()=>W(ga,"$liveFen",r),u=()=>W(xt,"$legalMoves",r),p=()=>W(J,"$gameStore",r),g=()=>W(yt,"$isCheck",r),b=()=>W(St,"$isGameOver",r),[r,i]=Ce();let m=xe(""),o=xe("");function f(){J.loadFen(a(m))?te(o,""):te(o,"Invalid FEN string")}function S(){navigator.clipboard.writeText(a(l))}function M(L){s()&&J.goToLive(),J.makeMove(L)}bt(()=>{te(m,a(l),!0)});const l=N(()=>s()?n():c()),y=N(()=>a(l).split(" ")[1]==="w"?"white":"black"),k=N(()=>{if(!s())return u();const L=fa(a(l));return L?_a(L):[]}),H=N(()=>{if(!s()){if(p().result){const L=p().result;return L==="white_wins"?"Checkmate - White wins":L==="black_wins"?"Checkmate - Black wins":L==="draw"?"Draw":L}return g()?"Check!":"In progress"}return"In progress"}),$=N(()=>a(y)==="white"?"White to move":"Black to move");var G=rs(),ee=h(_(G),2);{var D=L=>{var Z=as();x(L,Z)};z(ee,L=>{s()&&L(D)})}var O=h(ee,2),j=_(O),B=_(j);v(j);var ne=h(j,2),I=_(ne);Qe(I);var V=h(I,2);V.__click=f;var A=h(V,2);A.__click=S,v(ne);var F=h(ne,2);{var ae=L=>{var Z=ss(),ve=_(Z,!0);v(Z),K(()=>R(ve,a(o))),x(L,Z)};z(F,L=>{a(o)&&L(ae)})}v(O);var U=h(O,2),C=_(U),d=_(C);v(C);var w=h(C,2),E=h(_(w),2),P=_(E),q=h(P);v(E);var Q=h(E,4);let Y;var ue=_(Q,!0);v(Q);var re=h(Q,4),le=_(re,!0);v(re);var ie=h(re,4),we=_(ie,!0);v(ie),v(w),v(U);var ke=h(U,2),X=_(ke),oe=_(X);v(X);var se=h(X,2);_e(se,21,()=>a(k),fe,(L,Z)=>{var ve=ns();ve.__click=()=>M(a(Z).uci);var Me=_(ve,!0);v(ve),K(()=>R(Me,a(Z).uci)),x(L,ve)}),v(se),v(ke),v(G),K((L,Z)=>{R(B,`FEN ${s()?"(viewed)":""}`),R(d,`Game State ${s()?"(viewed)":""}`),Se(P,1,`dot ${a(y)??""}`,"svelte-1ftjkv9"),R(q,` ${a($)??""}`),Y=Se(Q,1,"svelte-1ftjkv9",null,Y,{check:!s()&&g(),"game-over":!s()&&b()}),R(ue,a(H)),R(le,L),R(we,Z),R(oe,`Legal Moves (${a(k).length??""}) ${s()?"(viewed)":""}`)},[()=>a(l).split(" ")[4]??"0",()=>a(l).split(" ")[5]??"1"]),$a(I,()=>a(m),L=>te(m,L)),x(e,G),he(),i()}Ie(["click"]);const it={connected:!1,connecting:!1,availableBots:[],activeSessions:new Map,whitePlayer:"human",blackPlayer:"human",autoPlay:!1,lastOutput:[],searchInfo:null,error:null};function ls(e){if(!e.startsWith("info "))return null;const t=e.split(" "),s={depth:0,score:0,nodes:0,time:0,pv:[]};for(let n=1;n<t.length;n++)switch(t[n]){case"depth":s.depth=parseInt(t[++n]||"0",10);break;case"score":if(t[n+1]==="cp")n++,s.score=parseInt(t[++n]||"0",10);else if(t[n+1]==="mate"){n++;const c=parseInt(t[++n]||"0",10);s.score=c>0?1e5-c:-1e5-c}break;case"nodes":s.nodes=parseInt(t[++n]||"0",10);break;case"time":s.time=parseInt(t[++n]||"0",10);break;case"pv":s.pv=t.slice(n+1),n=t.length;break}return s.depth>0?s:null}function is(){const{subscribe:e,set:t,update:s}=oa(it);let n=null,c=!1,u=null;function p(o){s(f=>{const S=[...f.lastOutput.slice(-99),JSON.stringify(o)];switch(o.type){case"bots":return{...f,availableBots:o.bots,connecting:!1,connected:!0,lastOutput:S};case"connected":{const M=new Map(f.activeSessions);return M.set(o.bot,{name:o.bot,ready:!1}),{...f,activeSessions:M,lastOutput:S}}case"disconnected":return{...f,lastOutput:S};case"error":return{...f,error:o.message,connecting:!1,lastOutput:S};case"uci":{const M=o.line;if(M==="readyok"&&u){const y=new Map(f.activeSessions),k=y.get(u);return k&&y.set(u,{...k,ready:!0}),{...f,activeSessions:y,lastOutput:S}}const l=ls(M);if(l)return{...f,lastOutput:S,searchInfo:l};if(M.startsWith("bestmove ")){const k=M.split(" ")[1];if(k&&k!=="(none)"&&k!=="0000"&&c){c=!1,u=null;const H=f.searchInfo;J.makeMove(k),H&&J.attachSearchInfoToLastMove(H)}return{...f,lastOutput:S,searchInfo:null}}return{...f,lastOutput:S}}default:return{...f,lastOutput:S}}})}function g(o){n&&n.readyState===WebSocket.OPEN&&n.send(JSON.stringify(o))}async function b(o){return Ge({subscribe:e}).activeSessions.has(o)||(g({type:"connect",bot:o}),await new Promise(S=>setTimeout(S,50)),g({type:"uci",cmd:"uci",bot:o}),g({type:"uci",cmd:"isready",bot:o}),await new Promise(S=>setTimeout(S,100))),!0}let r=null;async function i(){const o=Ge({subscribe:e}),f=Ge(J);if(!o.connected||!o.autoPlay||f.isGameOver)return;const S=f.sideToMove==="white"?o.whitePlayer:o.blackPlayer;if(S!=="human"&&!c){c=!0,u=S,await b(S);const M=f.moveHistory.map(l=>l.uci);g({type:"uci",cmd:`position startpos${M.length>0?" moves "+M.join(" "):""}`,bot:S}),g({type:"uci",cmd:"go movetime 500",bot:S})}}function m(){r||(r=J.subscribe(()=>{i()}))}return{subscribe:e,connect(o="ws://127.0.0.1:9999"){n&&n.close(),s(f=>({...f,connecting:!0,error:null})),n=new WebSocket(o),n.onopen=()=>{g({type:"list"}),m()},n.onmessage=f=>{try{const S=JSON.parse(f.data);p(S)}catch{console.error("Failed to parse message:",f.data)}},n.onerror=()=>{s(f=>({...f,error:"WebSocket connection error",connecting:!1}))},n.onclose=()=>{s(f=>({...f,connected:!1,connecting:!1,activeSessions:new Map})),n=null}},disconnect(){n&&(n.close(),n=null),t(it)},setWhitePlayer(o){s(f=>({...f,whitePlayer:o})),c=!1,u=null,setTimeout(()=>i(),0)},setBlackPlayer(o){s(f=>({...f,blackPlayer:o})),c=!1,u=null,setTimeout(()=>i(),0)},toggleAutoPlay(){s(o=>{const f=!o.autoPlay;return c=!1,u=null,{...o,autoPlay:f}}),setTimeout(()=>i(),0)},sendCommand(o){g({type:"uci",cmd:o})},clearError(){s(o=>({...o,error:null}))}}}const de=is(),Tt=Be(de,e=>e.connected),vs=Be(de,e=>e.availableBots),cs=Be(de,e=>e.searchInfo),us=Be(de,e=>e.lastOutput);var ds=T('<div class="error svelte-oan6v"> <button class="svelte-oan6v">Dismiss</button></div>'),fs=T('<button class="connect-btn svelte-oan6v">Connect to Bridge</button>'),_s=T('<button disabled class="connect-btn svelte-oan6v">Connecting...</button>'),ps=T('<div class="connected-status svelte-oan6v"><span class="status-dot svelte-oan6v"></span> Connected <button class="disconnect-btn svelte-oan6v">Disconnect</button></div>'),gs=T('<option class="svelte-oan6v"> </option>'),hs=T('<option class="svelte-oan6v"> </option>'),bs=T('<span class="thinking svelte-oan6v">(bot thinking...)</span>'),ms=T('<div class="turn-indicator svelte-oan6v"> <!></div>'),ws=T('<div class="player-assignment svelte-oan6v"><div class="player-row svelte-oan6v"><span class="player-label white-label svelte-oan6v">White:</span> <select class="svelte-oan6v"><option class="svelte-oan6v">Human</option><!></select></div> <div class="player-row svelte-oan6v"><span class="player-label black-label svelte-oan6v">Black:</span> <select class="svelte-oan6v"><option class="svelte-oan6v">Human</option><!></select></div></div> <div class="auto-play-section svelte-oan6v"><label class="auto-play-toggle svelte-oan6v"><input type="checkbox" class="svelte-oan6v"/> Auto-play enabled</label> <!></div>',1),ks=T('<div class="no-bots svelte-oan6v">No bots available</div>'),ys=T('<div class="bot-panel svelte-oan6v"><h3 class="svelte-oan6v">Bot Control</h3> <!> <div class="connection-section svelte-oan6v"><!></div> <!></div>');function xs(e,t){ge(t,!0);const s=()=>W(de,"$botStore",g),n=()=>W(Tt,"$isConnected",g),c=()=>W(vs,"$availableBots",g),u=()=>W(St,"$isGameOver",g),p=()=>W(kt,"$sideToMove",g),[g,b]=Ce();let r=N(()=>s().connecting),i=N(n),m=N(c),o=N(()=>s().whitePlayer),f=N(()=>s().blackPlayer),S=N(()=>s().autoPlay),M=N(()=>s().error);function l(){de.connect()}function y(){de.disconnect()}function k(A){const F=A.target;de.setWhitePlayer(F.value)}function H(A){const F=A.target;de.setBlackPlayer(F.value)}var $=ys(),G=h(_($),2);{var ee=A=>{var F=ds(),ae=_(F),U=h(ae);U.__click=()=>de.clearError(),v(F),K(()=>R(ae,`${a(M)??""} `)),x(A,F)};z(G,A=>{a(M)&&A(ee)})}var D=h(G,2),O=_(D);{var j=A=>{var F=fs();F.__click=l,x(A,F)},B=A=>{var F=$e(),ae=pe(F);{var U=d=>{var w=_s();x(d,w)},C=d=>{var w=ps(),E=h(_(w),2);E.__click=y,v(w),x(d,w)};z(ae,d=>{a(r)?d(U):d(C,!1)},!0)}x(A,F)};z(O,A=>{!a(i)&&!a(r)?A(j):A(B,!1)})}v(D);var ne=h(D,2);{var I=A=>{var F=ws(),ae=pe(F),U=_(ae),C=h(_(U),2);C.__change=k;var d=_(C);d.value=d.__value="human";var w=h(d);_e(w,17,()=>a(m),fe,(X,oe)=>{var se=gs(),L=_(se,!0);v(se);var Z={};K(()=>{R(L,a(oe)),Z!==(Z=a(oe))&&(se.value=(se.__value=a(oe))??"")}),x(X,se)}),v(C);var E;nt(C),v(U);var P=h(U,2),q=h(_(P),2);q.__change=H;var Q=_(q);Q.value=Q.__value="human";var Y=h(Q);_e(Y,17,()=>a(m),fe,(X,oe)=>{var se=hs(),L=_(se,!0);v(se);var Z={};K(()=>{R(L,a(oe)),Z!==(Z=a(oe))&&(se.value=(se.__value=a(oe))??"")}),x(X,se)}),v(q);var ue;nt(q),v(P),v(ae);var re=h(ae,2),le=_(re),ie=_(le);Qe(ie),ie.__change=()=>de.toggleAutoPlay(),mt(),v(le);var we=h(le,2);{var ke=X=>{var oe=ms(),se=_(oe),L=h(se);{var Z=ve=>{var Me=bs();x(ve,Me)};z(L,ve=>{(p()==="white"&&a(o)!=="human"||p()==="black"&&a(f)!=="human")&&ve(Z)})}v(oe),K(()=>R(se,`${p()==="white"?"White":"Black"} to move `)),x(X,oe)};z(we,X=>{a(S)&&!u()&&X(ke)})}v(re),K(()=>{E!==(E=a(o))&&(C.value=(C.__value=a(o))??"",ze(C,a(o))),ue!==(ue=a(f))&&(q.value=(q.__value=a(f))??"",ze(q,a(f))),xa(ie,a(S))}),x(A,F)},V=A=>{var F=$e(),ae=pe(F);{var U=C=>{var d=ks();x(C,d)};z(ae,C=>{a(i)&&C(U)},!0)}x(A,F)};z(ne,A=>{a(i)&&a(m).length>0?A(I):A(V,!1)})}v($),x(e,$),he(),b()}Ie(["click","change"]);var Ss=T(`<div class="history-notice svelte-w6adde">Viewing move's search info</div>`),Ms=T('<div class="placeholder svelte-w6adde">Connect to a bot to see debug info</div>'),Ts=T('<div class="output-line svelte-w6adde"> </div>'),$s=T('<div class="raw-output svelte-w6adde"></div>'),Is=T('<div class="pv-section svelte-w6adde"><span class="label svelte-w6adde">PV</span> <span class="pv-moves svelte-w6adde"> </span></div>'),Cs=T('<div class="search-info svelte-w6adde"><div class="info-grid svelte-w6adde"><div class="info-item svelte-w6adde"><span class="label svelte-w6adde">Depth</span> <span class="value svelte-w6adde"> </span></div> <div class="info-item svelte-w6adde"><span class="label svelte-w6adde">Score</span> <span> </span></div> <div class="info-item svelte-w6adde"><span class="label svelte-w6adde">Nodes</span> <span class="value svelte-w6adde"> </span></div> <div class="info-item svelte-w6adde"><span class="label svelte-w6adde">Time</span> <span class="value svelte-w6adde"> </span></div> <div class="info-item svelte-w6adde"><span class="label svelte-w6adde">NPS</span> <span class="value svelte-w6adde"> </span></div></div> <!></div>'),Es=T('<div class="placeholder svelte-w6adde">No search info for this move</div>'),Ps=T('<div class="placeholder svelte-w6adde">Waiting for search info...</div>'),Ls=T('<div class="debug-panel svelte-w6adde"><div class="header svelte-w6adde"><h3 class="svelte-w6adde">Bot Debug</h3> <label class="toggle svelte-w6adde"><input type="checkbox" class="svelte-w6adde"/> Raw</label></div> <!> <!></div>');function Ns(e,t){ge(t,!0);const s=()=>W(Tt,"$isConnected",g),n=()=>W(cs,"$searchInfo",g),c=()=>W(ha,"$viewSearchInfo",g),u=()=>W(Je,"$isViewingHistory",g),p=()=>W(us,"$lastOutput",g),[g,b]=Ce();let r=xe(!1),i=N(s),m=N(n),o=N(c),f=N(u),S=N(p),M=N(()=>a(o)??a(m));function l(I){if(Math.abs(I)>=9e4){const V=I>0?1e5-I:-1e5-I;return`M${V>0?V:-V}`}return(I/100).toFixed(2)}function y(I){return I>=1e6?`${(I/1e6).toFixed(1)}M`:I>=1e3?`${(I/1e3).toFixed(1)}k`:I.toString()}function k(I,V){if(V===0)return"-";const A=I/V*1e3;return y(Math.round(A))+"/s"}var H=Ls(),$=_(H),G=h(_($),2),ee=_(G);Qe(ee),mt(),v(G),v($);var D=h($,2);{var O=I=>{var V=Ss();x(I,V)};z(D,I=>{a(f)&&a(o)&&I(O)})}var j=h(D,2);{var B=I=>{var V=Ms();x(I,V)},ne=I=>{var V=$e(),A=pe(V);{var F=U=>{var C=$s();_e(C,21,()=>a(S).slice(-20),fe,(d,w)=>{var E=Ts(),P=_(E,!0);v(E),K(()=>R(P,a(w))),x(d,E)}),v(C),x(U,C)},ae=U=>{var C=$e(),d=pe(C);{var w=P=>{var q=Cs(),Q=_(q),Y=_(Q),ue=h(_(Y),2),re=_(ue,!0);v(ue),v(Y);var le=h(Y,2),ie=h(_(le),2);let we;var ke=_(ie);v(ie),v(le);var X=h(le,2),oe=h(_(X),2),se=_(oe,!0);v(oe),v(X);var L=h(X,2),Z=h(_(L),2),ve=_(Z);v(Z),v(L);var Me=h(L,2),Xe=h(_(Me),2),$t=_(Xe,!0);v(Xe),v(Me),v(Q);var It=h(Q,2);{var Ct=Ee=>{var Pe=Is(),Oe=h(_(Pe),2),Et=_(Oe,!0);v(Oe),v(Pe),K(Pt=>R(Et,Pt),[()=>a(M).pv.join(" ")]),x(Ee,Pe)};z(It,Ee=>{a(M).pv.length>0&&Ee(Ct)})}v(q),K((Ee,Pe,Oe)=>{R(re,a(M).depth),we=Se(ie,1,"value svelte-w6adde",null,we,{positive:a(M).score>0,negative:a(M).score<0}),R(ke,`${a(M).score>0?"+":""}${Ee??""}`),R(se,Pe),R(ve,`${a(M).time??""}ms`),R($t,Oe)},[()=>l(a(M).score),()=>y(a(M).nodes),()=>k(a(M).nodes,a(M).time)]),x(P,q)},E=P=>{var q=$e(),Q=pe(q);{var Y=re=>{var le=Es();x(re,le)},ue=re=>{var le=Ps();x(re,le)};z(Q,re=>{a(f)?re(Y):re(ue,!1)},!0)}x(P,q)};z(d,P=>{a(M)?P(w):P(E,!1)},!0)}x(U,C)};z(A,U=>{a(r)&&!a(f)?U(F):U(ae,!1)},!0)}x(I,V)};z(j,I=>{!a(i)&&!a(f)?I(B):I(ne,!1)})}v(H),Ia(ee,()=>a(r),I=>te(r,I)),x(e,H),he(),b()}var Os=T('<main class="svelte-1uha8ag"><header class="svelte-1uha8ag"><h1 class="svelte-1uha8ag">Chess Devtools</h1> <span class="subtitle svelte-1uha8ag">Test UI</span></header> <div class="game-container svelte-1uha8ag"><div class="controls-bar svelte-1uha8ag"><!></div> <div class="main-content svelte-1uha8ag"><div class="board-area svelte-1uha8ag"><!></div> <div class="side-panel svelte-1uha8ag"><!> <!> <!> <!></div></div></div></main>');function Fs(e,t){ge(t,!0);let s=xe(!1);function n(l){if(!(l.target instanceof HTMLInputElement||l.target instanceof HTMLTextAreaElement))switch(l.key){case"ArrowLeft":l.preventDefault(),J.viewPrev();break;case"ArrowRight":l.preventDefault(),J.viewNext();break;case"Home":l.preventDefault(),J.goToStart();break;case"End":l.preventDefault(),J.goToLive();break;case"f":l.preventDefault(),te(s,!a(s));break;case"n":l.preventDefault(),J.newGame();break}}var c=Os();Ne("keydown",ht,n);var u=h(_(c),2),p=_(u),g=_(p);Ua(g,{onflip:()=>te(s,!a(s))}),v(p);var b=h(p,2),r=_(b),i=_(r);Ga(i,{get flipped(){return a(s)}}),v(r);var m=h(r,2),o=_(m);xs(o,{});var f=h(o,2);Ns(f,{});var S=h(f,2);os(S,{});var M=h(S,2);ts(M,{}),v(m),v(b),v(u),v(c),x(e,c),he()}export{Fs as component};
